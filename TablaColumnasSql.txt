-- Tabla de creación de variables sql

CREATE TABLE respuestas_accesibilidad (
    cedula VARCHAR,
    orden1 INTEGER,
    respuesta1 TEXT,
    respuesta_otro1 TEXT,
    orden2 INTEGER,
    respuesta2 TEXT,
    respuesta_otro2 TEXT,
    orden3 INTEGER,
    respuesta3_1 TEXT,
    respuesta3_1_otro TEXT,
    orden4 INTEGER,
    respuesta4_4 TEXT,
    respuesta4_50_otro TEXT,
    respuesta4_54 TEXT,
    respuesta4_54_otro TEXT,
    respuesta4_64 TEXT,
    respuesta4_64_otro TEXT,
    respuesta4_69 TEXT,
    respuesta4_69_otro TEXT,
    respuesta4_73 TEXT,
    respuesta4_73_otro TEXT,
    orden5 INTEGER,
    respuesta5_2 TEXT,
    respuesta5_2_otro TEXT,
    orden6 INTEGER,
    respuesta6_102 TEXT,
    respuesta6_102_otro TEXT,
    respuesta6_113 TEXT,
    respuesta6_113_otro TEXT,
    respuesta6_115 TEXT,
    respuesta6_115_otro TEXT,
    respuesta6_51 TEXT,
    respuesta6_51_otro TEXT,
    respuesta6_55 TEXT,
    respuesta6_55_otro TEXT,
    respuesta6_6 TEXT,
    respuesta6_61_otro TEXT,
    respuesta6_7 TEXT,
    respuesta6_63_otro TEXT,
    respuesta6_65 TEXT,
    respuesta6_65_otro TEXT,
    respuesta6_80 TEXT,
    respuesta6_80_otro TEXT,
    orden7 INTEGER,
    respuesta7_103 TEXT,
    respuesta7_103_otro TEXT,
    respuesta7_52 TEXT,
    respuesta7_52_otro TEXT,
    respuesta7_56 TEXT,
    respuesta7_56_otro TEXT,
    respuesta7_62 TEXT,
    respuesta7_62_otro TEXT,
    respuesta7_66 TEXT,
    respuesta7_66_otro TEXT,
    respuesta7_70 TEXT,
    respuesta7_70_otro TEXT,
    respuesta7_78 TEXT,
    respuesta7_78_otro TEXT,
    orden8 INTEGER,
    respuesta8_100 TEXT,
    respuesta8_100_otro TEXT,
    respuesta8_3 TEXT,
    respuesta8_3_otro TEXT,
    respuesta8_44 TEXT,
    respuesta8_44_otro TEXT,
    respuesta8_57 TEXT,
    respuesta8_57_otro TEXT,
    respuesta8_74 TEXT,
    respuesta8_74_otro TEXT,
    respuesta8_76 TEXT,
    respuesta8_76_otro TEXT,
    respuesta8_85 TEXT,
    respuesta8_85_otro TEXT,
    respuesta8_86 TEXT,
    respuesta8_86_otro TEXT,
    respuesta8_87 TEXT,
    respuesta8_87_otro TEXT,
    respuesta8_89 TEXT,
    respuesta8_89_otro TEXT,
    respuesta8_92 TEXT,
    respuesta8_92_otro TEXT,
    respuesta8_96 TEXT,
    respuesta8_96_otro TEXT,
    orden9 INTEGER,
    respuesta9_10 TEXT,
    respuesta9_10_otro TEXT,
    respuesta9_11 TEXT,
    respuesta9_11_otro TEXT,
    respuesta9_12 TEXT,
    respuesta9_12_otro TEXT,
    respuesta9_13 TEXT,
    respuesta9_13_otro TEXT,
    respuesta9_4 TEXT,
    respuesta9_4_otro TEXT,
    respuesta9_5 TEXT,
    respuesta9_5_otro TEXT,
    respuesta9_6 TEXT,
    respuesta9_6_otro TEXT,
    respuesta9_7 TEXT,
    respuesta9_7_otro TEXT,
    respuesta9_8 TEXT,
    respuesta9_8_otro TEXT,
    respuesta9_9 TEXT,
    respuesta9_9_otro TEXT,
    orden10 INTEGER,
    respuesta10_14 TEXT,
    respuesta10_14_otro TEXT,
    respuesta10_15 TEXT,
    respuesta10_15_otro TEXT,
    respuesta10_16 TEXT,
    respuesta10_16_otro TEXT,
    respuesta10_17 TEXT,
    respuesta10_17_otro TEXT,
    respuesta10_18 TEXT,
    respuesta10_18_otro TEXT,
    respuesta10_19 TEXT,
    respuesta10_19_otro TEXT,
    respuesta10_20 TEXT,
    respuesta10_20_otro TEXT,
    respuesta10_21 TEXT,
    respuesta10_21_otro TEXT,
    respuesta10_22 TEXT,
    respuesta10_22_otro TEXT,
    respuesta10_23 TEXT,
    respuesta10_23_otro TEXT,
    respuesta10_24 TEXT,
    respuesta10_24_otro TEXT,
    orden11 INTEGER,
    respuesta11_25 TEXT,
    respuesta11_25_otro TEXT,
    respuesta11_26 TEXT,
    respuesta11_26_otro TEXT,
    respuesta11_27 TEXT,
    respuesta11_27_otro TEXT,
    respuesta11_28 TEXT,
    respuesta11_28_otro TEXT,
    respuesta11_29 TEXT,
    respuesta11_29_otro TEXT,
    respuesta11_30 TEXT,
    respuesta11_30_otro TEXT,
    respuesta11_31 TEXT,
    respuesta11_31_otro TEXT,
    respuesta11_32 TEXT,
    respuesta11_32_otro TEXT,
    respuesta11_33 TEXT,
    respuesta11_33_otro TEXT,
    respuesta11_34 TEXT,
    respuesta11_34_otro TEXT,
    respuesta11_35 TEXT,
    respuesta11_35_otro TEXT,
    orden12 INTEGER,
    respuesta12_36 TEXT,
    respuesta12_36_otro TEXT,
    respuesta12_37 TEXT,
    respuesta12_37_otro TEXT,
    respuesta12_38 TEXT,
    respuesta12_38_otro TEXT,
    respuesta12_39 TEXT,
    respuesta12_39_otro TEXT,
    respuesta12_40 TEXT,
    respuesta12_40_otro TEXT,
    respuesta12_41 TEXT,
    respuesta12_41_otro TEXT,
    respuesta12_42 TEXT,
    respuesta12_42_otro TEXT,
    respuesta12_43 TEXT,
    respuesta12_43_otro TEXT,
    orden13 INTEGER,
    respuesta13_45 TEXT,
    respuesta13_45_otro TEXT,
    orden14 INTEGER,
    respuesta14_46 TEXT,
    respuesta14_46_otro TEXT,
    orden15 INTEGER,
    respuesta15_47 TEXT,
    respuesta15_47_otro TEXT,
    orden16 INTEGER,
    respuesta16_105 TEXT,
    respuesta16_105_otro TEXT,
    respuesta16_107 TEXT,
    respuesta16_107_otro TEXT,
    respuesta16_116 TEXT,
    respuesta16_116_otro TEXT,
    respuesta16_48 TEXT,
    respuesta16_48_otro TEXT,
    respuesta16_53 TEXT,
    respuesta16_53_otro TEXT,
    respuesta16_58 TEXT,
    respuesta16_58_otro TEXT,
    respuesta16_67 TEXT,
    respuesta16_67_otro TEXT,
    respuesta16_71 TEXT,
    respuesta16_71_otro TEXT,
    respuesta16_79 TEXT,
    respuesta16_79_otro TEXT,
    respuesta16_81 TEXT,
    respuesta16_81_otro TEXT,
    respuesta16_83 TEXT,
    respuesta16_83_otro TEXT,
    respuesta16_93 TEXT,
    respuesta16_93_otro TEXT,
    respuesta16_99 TEXT,
    respuesta16_99_otro TEXT,
    orden19 INTEGER,
    orden20 INTEGER,
    respuesta20_101 TEXT,
    respuesta20_101_otro TEXT,
    respuesta20_104 TEXT,
    respuesta20_104_otro TEXT,
    respuesta20_106 TEXT,
    respuesta20_106_otro TEXT,
    respuesta20_108 TEXT,
    respuesta20_108_otro TEXT,
    respuesta20_109 TEXT,
    respuesta20_109_otro TEXT,
    respuesta20_110 TEXT,
    respuesta20_110_otro TEXT,
    respuesta20_111 TEXT,
    respuesta20_111_otro TEXT,
    respuesta20_112 TEXT,
    respuesta20_112_otro TEXT,
    respuesta20_114 TEXT,
    respuesta20_114_otro TEXT,
    respuesta20_49 TEXT,
    respuesta20_49_otro TEXT,
    respuesta20_59 TEXT,
    respuesta20_59_otro TEXT,
    respuesta20_60 TEXT,
    respuesta20_60_otro TEXT,
    respuesta20_68 TEXT,
    respuesta20_68_otro TEXT,
    respuesta20_72 TEXT,
    respuesta20_72_otro TEXT,
    respuesta20_75 TEXT,
    respuesta20_75_otro TEXT,
    respuesta20_77 TEXT,
    respuesta20_77_otro TEXT,
    respuesta20_82 TEXT,
    respuesta20_82_otro TEXT,
    respuesta20_84 TEXT,
    respuesta20_84_otro TEXT,
    respuesta20_88 TEXT,
    respuesta20_88_otro TEXT,
    respuesta20_90 TEXT,
    respuesta20_90_otro TEXT,
    respuesta20_91 TEXT,
    respuesta20_91_otro TEXT,
    respuesta20_94 TEXT,
    respuesta20_94_otro TEXT,
    respuesta20_95 TEXT,
    respuesta20_95_otro TEXT,
    respuesta20_97 TEXT,
    respuesta20_97_otro TEXT,
    respuesta20_98 TEXT,
    respuesta20_98_otro TEXT
);

-- Uso del cliente psql para importar los datos

psql -U postgres -d encuesta_accesibilidad

-- Poner el archivo en la plantilla (tabla creada)
\COPY respuestas_accesibilidad 
FROM '/home/vospi97/PROYECTO ACCESIBILIDAD/Prácticas/ANÁLISIS DE DATOS 20241204/RespuestasLimpio20241204.csv' 
DELIMITER ';' 
CSV HEADER 
ENCODING 'UTF-8';

-- Listar todas las columnas
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'respuestas_accesibilidad';


#####################################################################################################3

Columnas de tabla del 10 de enero de 2025


CREATE TABLE tabla_20250109 (
    Cedula TEXT,
    Orden1 INTEGER,
    Respuesta1 TEXT,
    Orden2 INTEGER,
    Respuesta2 TEXT,
    Orden3 INTEGER,
    Respuesta3 TEXT,
    Orden4 INTEGER,
    Respuesta4_42 TEXT,
    Respuesta4_44 TEXT,
    Respuesta4_53 TEXT,
    Respuesta4_58 TEXT,
    Respuesta4_64 TEXT,
    Orden5 INTEGER,
    Respuesta5 TEXT,
    Orden6 INTEGER,
    Respuesta6_43 TEXT,
    Respuesta6_45 TEXT,
    Respuesta6_55 TEXT,
    Respuesta6_3 TEXT,
    Respuesta6_59 TEXT,
    Respuesta6_60 TEXT,
    Respuesta6_62 TEXT,
    Respuesta6_67 TEXT,
    Respuesta6_74 TEXT,
    Respuesta6_75 TEXT,
    Orden7 INTEGER,
    Respuesta7_46 TEXT,
    Respuesta7_48 TEXT,
    Respuesta7_48_Otro TEXT,
    Respuesta7_3 TEXT,
    Respuesta7_60 TEXT,
    Respuesta7_63 TEXT,
    Respuesta7_66 TEXT,
    Respuesta7_73 TEXT,
    Orden8 INTEGER,
    Respuesta8_1 TEXT,
    Respuesta8_49 TEXT,
    Respuesta8_50 TEXT,
    Respuesta8_51 TEXT,
    Respuesta8_52 TEXT,
    Respuesta8_54 TEXT,
    Respuesta8_65 TEXT,
    Respuesta8_68 TEXT,
    Respuesta8_69 TEXT,
    Respuesta8_70 TEXT,
    Respuesta8_71 TEXT,
    Respuesta8_72 TEXT,
    Respuesta8_76 TEXT,
    Orden9 INTEGER,
    Respuesta9_10 TEXT,
    Respuesta9_10_Otro TEXT,
    Respuesta9_11 TEXT,
    Respuesta9_11_Otro TEXT,
    Respuesta9_2 TEXT,
    Respuesta9_2_Otro TEXT,
    Respuesta9_3 TEXT,
    Respuesta9_3_Otro TEXT,
    Respuesta9_4 TEXT,
    Respuesta9_4_Otro TEXT,
    Respuesta9_5 TEXT,
    Respuesta9_5_Otro TEXT,
    Respuesta9_6 TEXT,
    Respuesta9_6_Otro TEXT,
    Respuesta9_7 TEXT,
    Respuesta9_7_Otro TEXT,
    Respuesta9_8 TEXT,
    Respuesta9_8_Otro TEXT,
    Respuesta9_9 TEXT,
    Respuesta9_9_Otro TEXT,
    Orden10 INTEGER,
    Respuesta10_12 TEXT,
    Respuesta10_12_Otro TEXT,
    Respuesta10_13 TEXT,
    Respuesta10_13_Otro TEXT,
    Respuesta10_14 TEXT,
    Respuesta10_14_Otro TEXT,
    Respuesta10_15 TEXT,
    Respuesta10_15_Otro TEXT,
    Respuesta10_16 TEXT,
    Respuesta10_16_Otro TEXT,
    Respuesta10_17 TEXT,
    Respuesta10_17_Otro TEXT,
    Respuesta10_18 TEXT,
    Respuesta10_18_Otro TEXT,
    Respuesta10_19 TEXT,
    Respuesta10_19_Otro TEXT,
    Respuesta10_20 TEXT,
    Respuesta10_20_Otro TEXT,
    Respuesta10_21 TEXT,
    Respuesta10_21_Otro TEXT,
    Respuesta10_22 TEXT,
    Respuesta10_22_Otro TEXT,
    Orden11 INTEGER,
    Respuesta11_23 TEXT,
    Respuesta11_23_Otro TEXT,
    Respuesta11_24 TEXT,
    Respuesta11_24_Otro TEXT,
    Respuesta11_25 TEXT,
    Respuesta11_25_Otro TEXT,
    Respuesta11_26 TEXT,
    Respuesta11_26_Otro TEXT,
    Respuesta11_27 TEXT,
    Respuesta11_27_Otro TEXT,
    Respuesta11_28 TEXT,
    Respuesta11_28_Otro TEXT,
    Respuesta11_29 TEXT,
    Respuesta11_29_Otro TEXT,
    Respuesta11_30 TEXT,
    Respuesta11_30_Otro TEXT,
    Respuesta11_31 TEXT,
    Respuesta11_31_Otro TEXT,
    Respuesta11_32 TEXT,
    Respuesta11_32_Otro TEXT,
    Respuesta11_33 TEXT,
    Respuesta11_33_Otro TEXT,
    Orden12 INTEGER,
    Respuesta12_34 TEXT,
    Respuesta12_34_Otro TEXT,
    Respuesta12_35 TEXT,
    Respuesta12_35_Otro TEXT,
    Respuesta12_36 TEXT,
    Respuesta12_36_Otro TEXT,
    Respuesta12_37 TEXT,
    Respuesta12_37_Otro TEXT,
    Respuesta12_38 TEXT,
    Respuesta12_38_Otro TEXT,
    Respuesta12_39 TEXT,
    Respuesta12_39_Otro TEXT,
    Respuesta12_40 TEXT,
    Respuesta12_40_Otro TEXT,
    Respuesta12_41 TEXT,
    Respuesta12_41_Otro TEXT,
    Orden13 INTEGER,
    Respuesta13 TEXT,
    Orden14 INTEGER,
    Respuesta14 TEXT,
    Orden15 INTEGER,
    Respuesta15_47 TEXT,
    Orden16 INTEGER,
    Respuesta16 TEXT,
    Orden19 INTEGER,
    Respuesta19 TEXT,
    Orden20 INTEGER,
    Respuesta20 TEXT
);

-- Cambiar los nombres de las columnas:

ALTER TABLE nueva_tabla RENAME COLUMN Orden1 TO Pregunta1Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden2 TO Pregunta2Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden3 TO Pregunta3Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden4 TO Pregunta4Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden5 TO Pregunta5Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden6 TO Pregunta6Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden7 TO Pregunta7Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden8 TO Pregunta8Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden9 TO Pregunta9Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden10 TO Pregunta10Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden11 TO Pregunta11Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden12 TO Pregunta12Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden13 TO Pregunta13Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden14 TO Pregunta14Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden15 TO Pregunta15Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden16 TO Pregunta16Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden19 TO Pregunta19Respondida;
ALTER TABLE nueva_tabla RENAME COLUMN Orden20 TO Pregunta20Respondida;


--
DO $$
DECLARE 
   i INTEGER;
BEGIN
   FOR i IN 1..20 LOOP
       IF i NOT IN (17, 18) THEN  -- Asegúrate de excluir Orden17 y Orden18 si no existen
           BEGIN
               EXECUTE format('ALTER TABLE tabla_20250109 RENAME COLUMN Orden%d TO Pregunta%dRespondida;', i, i);
               RAISE NOTICE 'Columna Orden% renombrada a Pregunta%Respondida.', i, i;
           EXCEPTION WHEN undefined_column THEN
               RAISE NOTICE 'Columna Orden% no existe, no se pudo renombrar.', i;
           END;
       END IF;
   END LOOP;
END $$;


